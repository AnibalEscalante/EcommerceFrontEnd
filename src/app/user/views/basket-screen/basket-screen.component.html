<app-navbar></app-navbar>
<div class="container-fluid">
	<div class="row justify-content-center">
		<div class="col-10 justify-content-center mt-2">
			<div class="position-relative m-4">
				<div class="progress">
				  <div [ngStyle]="{'width': widthBar}" class="progress-bar" role="progressbar" aria-valuenow="50" aria-valuemin="0" aria-valuemax="100"></div>
				</div>
				<button (click)="changePos('step1')" type="button" class="btn steep-phase start-0">1</button>
				<button [disabled]="pos !== 'step2' && pos !== 'step3'" (click)="changePos('step2')" type="button" class="btn steep-phase start-50">2</button>
				<button [disabled]="pos !== 'step3'" (click)="changePos('step3')" type="button" class="btn steep-phase start-100">3</button>
			</div>
		</div> 
	</div>

	<!-- start step 1 -->

	<div *ngIf="pos === 'step1'" class="step-1">
		<div class="row justify-content-evenly mt-2">
			<div class="col-11 col-lg-7">
				<div class="card">
					<h5 class="title-list">Carro: 2 productos</h5>
				</div>
				<div class="content-list"> <!-- a for here -->
					<app-product-item></app-product-item>
				</div>
			</div>
	
			<div class="col-4 col-lg-3 d-none d-lg-block">
				<div class="card resume">
					<h5 class="title-resume">Resumen de Compra</h5>
					<div class="d-flex justify-content-between p-2">
						<p class="total-price">Total:</p>
						<p class="total-price">$ 45.000</p>
					</div>
					<button (click)="changePos('step2')" type="button" class="btn btn-continue">Continuar compra</button>
				</div>
			</div>
	
			<!-- responsive start -->
	
			<div class="col-11 d-lg-none summary-purchase">
				<div class="card resume shadow">
					<h5 class="title-resume">Resumen de Compra</h5>
					<div class="d-flex justify-content-between p-2">
						<p class="total-price">Total:</p>
						<p class="total-price">$ 45.000</p>
					</div>
					<button (click)="changePos('step2')" type="button" class="btn btn-continue">Continuar compra</button>
				</div>
			</div>
	
			<!-- responsive end -->
		</div>
	</div>

	<!-- end step 1 -->

	<!-- start step 2 -->

	<div *ngIf="pos === 'step2'" class="step-2">
		<div class="row justify-content-evenly mt-2">
			<div class="col-11 col-lg-7 mb-3">

				<div class="card mb-3">
					<div class="direction-card">
						<div class="d-flex align-items-baseline">
							<i class="fas fa-map-marker-alt"></i>
							<p class="direction">Dirección: Calle Colo-Colo, 523, Cerro O'Higgins</p>
						</div>
						<div>
							<p type="button" class="mb-0" data-bs-toggle="collapse" data-bs-target="#editAddressCollapse">
								cambiar
								<i class="fas fa-edit"></i>
							</p>
						</div>
					</div>
	
					<!-- responsive start -->
	
					<div class="direction-card-r">
						<div class="d-flex align-items-center">
							<i class="fas fa-map-marker-alt"></i>
							<div>
								<p class="direction">Dirección:</p>
								<p class="direction">Calle Colo-Colo, 523, Cerro O'Higgins</p>
							</div>
						</div>
						<i type="button" class="fas fa-edit" data-bs-toggle="collapse" data-bs-target="#editAddressCollapse"></i>
					</div>
	
					<!-- responsive end -->

					<div class="collapse" id="editAddressCollapse">
						<app-address></app-address>
					</div>

				</div>

				<div class="card p-3">
					<h5 class="bill">Envío de factura y comprobante</h5>
					<div class="col d-flex justify-content-between mb-3">
						<p class="email">Correo: correoElectronico@gmail.com</p>

						<div class="btn-edit">
							<p type="button" class="mb-0" data-bs-toggle="modal" data-bs-target="#changeEmailModal">
								cambiar
								<i class="fas fa-edit"></i>
							</p>
						</div>

						<!-- responsive start -->

						<div class="btn-edit-r">
							<p type="button" class="mb-0">
								<i class="fas fa-edit" data-bs-toggle="modal" data-bs-target="#changeEmailModal"></i>
							</p>
						</div>

						<!-- responsive end -->

					</div>
					<div class="col mb-3">
						<h5 class="type-delivery-title">Tipo de entrega:</h5>
					</div>

					<app-distribution-item></app-distribution-item>

					

				</div>
			</div>
			<div class="col-11 col-lg-4">
				<div class="card resume-buy">
					<h5 class="title-resume">Resumen de Compra</h5>
					<div class="d-flex justify-content-between p-2"> <!-- if there are more charges, show here -->
						<p class="total-price">Total:</p>
						<p class="total-price">$ 45.000</p>
					</div>
					<div class="center-btn">
						<button [disabled]="activeDelivery == false && activeStore == false" (click)="changePos('step3')" type="button" class="btn btn-buy">Ir a pagar</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- end step 2 -->

	<!-- start step 3 -->

	<div *ngIf="pos === 'step3'" class="step-3">
		<div class="row d-flex justify-content-evenly">
			<div class="col-7">
				<div class="card p-3">
					<h3 class="fs-3">Seleccione una tarjeta:</h3>

					<div class="card card-payment">
						<div class="form-check">
							<input class="form-check-input me-2" type="radio" id="radioButton" name="radioButton">
							<label class="form-check-label" for="radioButton">
								<p class="fs-6 mb-0">Master Card, 4120 **** **** ****</p>
							</label>
						</div>
					</div>

				</div>
			</div>
			<div class="col-3">
				<div class="card p-3">
					<h3 class="fs-6">Información de la compra</h3>
				</div>
			</div>
		</div>
	</div>

	<!-- end step 3 -->


</div>

<!----------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->
<!-------------------------------------------------- MODALS HERE -------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->
<!----------------------------------------------------------------------------------------------------------------->


<div  class="modal fade" id="changeEmailModal" tabindex="-1" aria-labelledby="changeEmailModalLabel" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered">
		<div class="modal-content">
			<div class="modal-header">
				<h5 class="modal-title" id="changeDirectionLabel">Cambiar Correo Electrónico</h5>
				<button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			</div>
			<form [formGroup]="emailForm" (ngSubmit)="onSubmitChangeEmail()">
				<div class="modal-body">

					<mat-form-field appearance="outline">
						<mat-label>Correo Electrónico</mat-label>
						<input type="email" formControlName="email" matInput #email placeholder="ejemplo123@dom.com" required>
						<mat-error *ngIf="email">{{getEmailErrorMessage()}}</mat-error>
					</mat-form-field>

				</div>

				<div class="modal-footer">
					<button type="button" class="btn btn-cancel" data-bs-dismiss="modal">Cancelar</button>
					<button type="submit" class="btn btn-save">Guardar</button>
				</div>

			</form>
		</div>
	</div>
</div>